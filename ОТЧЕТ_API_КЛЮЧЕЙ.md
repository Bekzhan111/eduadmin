# üìä –û—Ç—á–µ—Ç –ø–æ –ø—Ä–æ–≤–µ—Ä–∫–µ API –∫–ª—é—á–µ–π –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π

## ‚úÖ –°—Ç–∞—Ç—É—Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- **SUPABASE_URL**: ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- **ANON_KEY**: ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω  
- **SERVICE_ROLE_KEY**: ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

## üîê –î–æ—Å—Ç—É–ø –∫ —Ç–∞–±–ª–∏—Ü–∞–º

### ANON_KEY (–ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á)
- ‚úÖ **users**: –î–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–µ—à–µ–Ω (1 –∑–∞–ø–∏—Å—å)
- ‚úÖ **schools**: –î–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–µ—à–µ–Ω (1 –∑–∞–ø–∏—Å—å)
- ‚úÖ **registration_keys**: –î–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–µ—à–µ–Ω (1 –∑–∞–ø–∏—Å—å)
- ‚úÖ **books**: –î–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–µ—à–µ–Ω (0 –∑–∞–ø–∏—Å–µ–π)

### SERVICE_ROLE_KEY (–°–µ—Ä–≤–∏—Å–Ω—ã–π –∫–ª—é—á)
- ‚úÖ **users**: –î–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–µ—à–µ–Ω (1 –∑–∞–ø–∏—Å—å)
- ‚úÖ **schools**: –î–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–µ—à–µ–Ω (1 –∑–∞–ø–∏—Å—å)
- ‚úÖ **registration_keys**: –î–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–µ—à–µ–Ω (1 –∑–∞–ø–∏—Å—å)
- ‚úÖ **books**: –î–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–µ—à–µ–Ω (0 –∑–∞–ø–∏—Å–µ–π)

## üîß –§—É–Ω–∫—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **get_dashboard_summary**: –§—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞
- ‚úÖ **create_registration_key**: –§—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞
- ‚úÖ **register_with_key**: –§—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞
- ‚úÖ **assign_student_keys_to_teacher**: –§—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞

## üóùÔ∏è –ö–ª—é—á–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ —Ä–æ–ª—è–º

| –†–æ–ª—å | –í—Å–µ–≥–æ –∫–ª—é—á–µ–π | –ê–∫—Ç–∏–≤–Ω—ã—Ö –∫–ª—é—á–µ–π | –°—Ç–∞—Ç—É—Å |
|------|-------------|----------------|---------|
| **SUPER_ADMIN** | 0 | 0 | ‚ö†Ô∏è –ù–µ—Ç –∫–ª—é—á–µ–π |
| **SCHOOL** | 10 | 7 | ‚úÖ –•–æ—Ä–æ—à–æ |
| **TEACHER** | 120 | 120 | ‚úÖ –û—Ç–ª–∏—á–Ω–æ |
| **STUDENT** | 800 | 799 | ‚úÖ –û—Ç–ª–∏—á–Ω–æ |
| **AUTHOR** | 4 | 4 | ‚úÖ –•–æ—Ä–æ—à–æ |
| **MODERATOR** | 2 | 2 | ‚úÖ –•–æ—Ä–æ—à–æ |

## üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ —Ä–æ–ª—è–º

| –†–æ–ª—å | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | –ü—Ä–∏–≤—è–∑–∫–∞ –∫ —à–∫–æ–ª–µ | –°—Ç–∞—Ç—É—Å |
|------|-------------------------|------------------|---------|
| **SUPER_ADMIN** | 2 | N/A | ‚úÖ –ù–æ—Ä–º–∞–ª—å–Ω–æ |
| **SCHOOL** | 3 | N/A | ‚úÖ –ù–æ—Ä–º–∞–ª—å–Ω–æ |
| **TEACHER** | 0 | 0/0 | ‚ö†Ô∏è –ù–µ—Ç —É—á–∏—Ç–µ–ª–µ–π |
| **STUDENT** | 10 | 1/10 | ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ –ø—Ä–∏–≤—è–∑–∫–∏ |
| **AUTHOR** | 0 | N/A | ‚ö†Ô∏è –ù–µ—Ç –∞–≤—Ç–æ—Ä–æ–≤ |
| **MODERATOR** | 0 | N/A | ‚ö†Ô∏è –ù–µ—Ç –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–≤ |

## üö® –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. ‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
- **–°—Ç—É–¥–µ–Ω—Ç—ã –±–µ–∑ —à–∫–æ–ª—ã**: 9 –∏–∑ 10 —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ —à–∫–æ–ª–µ
- **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —É—á–∏—Ç–µ–ª–µ–π**: –ù–µ—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —É—á–∏—Ç–µ–ª–µ–π
- **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∞–≤—Ç–æ—Ä–æ–≤**: –ù–µ—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∞–≤—Ç–æ—Ä–æ–≤

### 2. ‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- **–ù–µ—Ç –∫–ª—é—á–µ–π –¥–ª—è super_admin**: –ú–æ–∂–µ—Ç –∑–∞—Ç—Ä—É–¥–Ω–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
- **–ü–æ–ª–∏—Ç–∏–∫–∏ RLS**: –ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ–≤–µ—Ä–∏—Ç—å (—Ç–∞–±–ª–∏—Ü–∞ pg_policies –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞)

### 3. ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö–æ—Ä–æ—à–æ
- –í—Å–µ API –∫–ª—é—á–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–Ω—ã
- –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫–ª—é—á–µ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Ä–æ–ª–µ–π
- –ï—Å—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –∏ —à–∫–æ–ª—ã

## üîß –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:
1. **–ü—Ä–∏–≤—è–∑–∞—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∫ —à–∫–æ–ª–∞–º**:
   ```sql
   -- –ù–∞–π—Ç–∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –±–µ–∑ —à–∫–æ–ª—ã
   SELECT id, email FROM users WHERE role = 'student' AND school_id IS NULL;
   
   -- –ü—Ä–∏–≤—è–∑–∞—Ç—å –∫ —à–∫–æ–ª–µ (–∑–∞–º–µ–Ω–∏—Ç–µ school_id –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π)
   UPDATE users SET school_id = 'your-school-id' WHERE role = 'student' AND school_id IS NULL;
   ```

2. **–°–æ–∑–¥–∞—Ç—å –∫–ª—é—á–∏ –¥–ª—è super_admin**:
   ```sql
   INSERT INTO registration_keys (role, max_uses, expires_at, is_active)
   VALUES ('super_admin', 5, NOW() + INTERVAL '30 days', true);
   ```

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:
1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –ø—Ä–∏–≤—è–∑–∫—É —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∫ —à–∫–æ–ª–∞–º –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
2. –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Ü–µ–¥—É—Ä—É –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–ª—é—á–µ–π
4. –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

- **–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª—é—á–µ–π**: 936
- **–ê–∫—Ç–∏–≤–Ω—ã—Ö –∫–ª—é—á–µ–π**: 932 (99.6%)
- **–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**: 15
- **–®–∫–æ–ª –≤ —Å–∏—Å—Ç–µ–º–µ**: 1+

## üîç –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–∏–≤—è–∑–∫—É —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∫ —à–∫–æ–ª–∞–º
2. ‚úÖ –°–æ–∑–¥–∞—Ç—å –∫–ª—é—á–∏ –¥–ª—è super_admin
3. ‚úÖ –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã—Ö —É—á–∏—Ç–µ–ª–µ–π –∏ –∞–≤—Ç–æ—Ä–æ–≤
4. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –≤—Å–µ—Ö —Ä–æ–ª–µ–π –≤ Dashboard
5. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã 